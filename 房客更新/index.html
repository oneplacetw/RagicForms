<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <!-- åŸºæœ¬HTMLæ–‡ä»¶è¨­å®šï¼ŒåŒ…å«å­—å…ƒç·¨ç¢¼å’Œæ¨™é¡Œ -->
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  
  <!-- è¼‰å…¥LINE LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  
  <!-- è¨­å®šéŸ¿æ‡‰å¼è¨­è¨ˆçš„è¦–çª—åƒæ•¸ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Open Graph é è¦½è¨­å®šï¼Œç”¨æ–¼ç¤¾ç¾¤åª’é«”åˆ†äº«æ™‚çš„é è¦½ -->
  <meta property="og:title" content="ä¸€æ–¹æˆ¿å®¢å°ˆç”¨">
  <meta property="og:description" content="å—¨ğŸ‘‹éº»ç…©æ‚¨çœŸä¸å¥½æ„æ€">
  <meta property="og:url" content="https://liff.line.me/2006833424-LyakNG2R">
  <meta property="og:type" content="website">

  <style>
    /* å…¨åŸŸæ¨£å¼è¨­å®šï¼šç§»é™¤é è¨­é‚Šè·ï¼Œè¨­å®šå…¨è¢å¹•é«˜åº¦ï¼Œç½®ä¸­å°é½Š */
    html, body {
      margin: 0;
      padding: 0;
      height: 100vh;
      background-color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    /* Logoå®¹å™¨çš„åŸºæœ¬æ¨£å¼è¨­å®š */
    .logo-container {
      position: relative;
      width: 280px;
      height: 156px;
      max-width: 90vw;
    }

    /* Logoåœ–ç‰‡çš„å…±åŒæ¨£å¼è¨­å®š */
    .green-logo, .gray-logo {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    /* ç°è‰²Logoçš„å‹•ç•«æ•ˆæœè¨­å®š */
    .gray-logo {
      z-index: 2;
      clip-path: inset(0 100% 0 0);
      animation: revealLogo 1s ease-out forwards;
      animation-delay: 0.5s;
    }

    /* ç¶ è‰²Logoä½œç‚ºèƒŒæ™¯å±¤ */
    .green-logo {
      z-index: 1;
    }

    /* Logoé¡¯ç¤ºå‹•ç•«çš„é—œéµå½±æ ¼å®šç¾© */
    @keyframes revealLogo {
      0% { clip-path: inset(0 100% 0 0); }
      100% { clip-path: inset(0 0% 0 0); }
    }

    /* é›»è…¦ç‰ˆQR codeé¡¯ç¤ºå®¹å™¨ */
    .desktop-container {
      display: none; /* é è¨­éš±è—ï¼Œåƒ…åœ¨é›»è…¦ç‰ˆé¡¯ç¤º */
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 40px;
      max-width: 500px;
    }

    /* QR codeå€å¡Šæ¨£å¼ */
    .qr-section {
      background: #f8f9fa;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin: 20px 0;
    }

    /* QR codeæ¨™é¡Œæ¨£å¼ */
    .qr-title {
      color: #333;
      font-size: 20px;
      margin-bottom: 15px;
      font-weight: bold;
    }

    /* QR codeæè¿°æ–‡å­—æ¨£å¼ */
    .qr-description {
      color: #666;
      font-size: 14px;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    /* QR codeç•«å¸ƒå®¹å™¨ */
    .qr-canvas {
      margin: 0 auto;
      border-radius: 10px;
      background: white;
      padding: 15px;
    }

    /* æ¡Œé¢ç‰ˆLogoæ¨£å¼ */
    .desktop-logo {
      width: 200px;
      height: auto;
      margin-bottom: 20px;
    }

    /* QR codeå®¹å™¨ç›¸å°å®šä½ï¼Œç”¨æ–¼æ”¾ç½®ä¸­å¿ƒlogo */
    .qr-container {
      position: relative;
      display: inline-block;
    }

    /* QR codeä¸­å¿ƒçš„logoæ¨£å¼ */
    .qr-center-logo {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 6px;
      padding: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    /* åª’é«”æŸ¥è©¢ï¼šåˆ¤æ–·æ˜¯å¦ç‚ºé›»è…¦ç‰ˆç•«é¢ */
    @media (min-width: 768px) {
      .logo-container {
        display: none; /* éš±è—æ‰‹æ©Ÿç‰ˆLogo */
      }
      .desktop-container {
        display: flex; /* é¡¯ç¤ºé›»è…¦ç‰ˆQR codeä»‹é¢ */
      }
    }
  </style>
</head>
<body>
  <!-- æ‰‹æ©Ÿç‰ˆé¡¯ç¤ºï¼šåŸæœ¬çš„Logoå‹•ç•«æ•ˆæœ -->
  <div class="logo-container">
    <img class="gray-logo" src="../gray.png" alt="Logo Gray">
    <img class="green-logo" src="https://r-forms.oneplace.com.tw/green.png" alt="Logo Green">
  </div>

  <!-- é›»è…¦ç‰ˆé¡¯ç¤ºï¼šQR codeæƒæä»‹é¢ -->
  <div class="desktop-container">
    <div class="qr-section">
      <div class="qr-title">è«‹æƒæQrcode é–‹å•ŸLINE</div>
      <div class="qr-description">
        è«‹ä½¿ç”¨æ‚¨çš„æ‰‹æ©Ÿæ‰“é–‹LINEæ‡‰ç”¨ç¨‹å¼ï¼Œ<br>
        æƒæä¸‹æ–¹QR Codeå³å¯é–‹å§‹å¡«å¯«è¡¨å–®
      </div>
      <div class="qr-container">
        <img id="qrcode" class="qr-canvas" alt="QR Code">
        <!-- Logoå·²èå…¥QR codeä¸­ï¼Œä¸éœ€è¦åˆ†é›¢çš„logoå…ƒç´  -->
      </div>
    </div>
  </div>

<script>
  // ç”ŸæˆQR codeçš„å‡½å¼ (ä½¿ç”¨æ”¯æ´logoåµŒå…¥çš„API)
  function generateQRCode() {
    const liffUrl = 'https://liff.line.me/2006833424-LyakNG2R';
    const logoUrl = 'https://r-forms.oneplace.com.tw/green.png';
    const qrImg = document.getElementById('qrcode');
    
    // ä½¿ç”¨æ”¯æ´logoåµŒå…¥å’Œè‡ªè¨‚é¡è‰²çš„QR code API
    const qrAPIs = [
      // API 1: QR Server with custom colors and logo
      `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(liffUrl)}&color=4a5d23&bgcolor=ffffff&format=png&logo=${encodeURIComponent(logoUrl)}`,
      
      // API 2: QuickChart with logo and custom styling
      `https://quickchart.io/qr?text=${encodeURIComponent(liffUrl)}&size=200&centerImageUrl=${encodeURIComponent(logoUrl)}&margin=1&dark=4a5d23&light=ffffff`,
      
      // API 3: å‚™ç”¨æ–¹æ¡ˆ
      `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(liffUrl)}&color=4a5d23&bgcolor=ffffff`
    ];
    
    // å˜—è©¦è¼‰å…¥ç¬¬ä¸€å€‹API (å¸¶logo)
    qrImg.src = qrAPIs[0];
    qrImg.style.width = '200px';
    qrImg.style.height = '200px';
    qrImg.style.display = 'block';
    qrImg.style.borderRadius = '15px'; // è¶…åœ“è§’æ•ˆæœ
    
    // å¦‚æœç¬¬ä¸€å€‹å¤±æ•—ï¼Œå˜—è©¦å‚™ç”¨API
    qrImg.onerror = function() {
      console.log('First QR API failed, trying QuickChart...');
      qrImg.src = qrAPIs[1];
      
      qrImg.onerror = function() {
        console.log('QuickChart failed, trying basic QR...');
        qrImg.src = qrAPIs[2];
        
        qrImg.onerror = function() {
          console.error('All QR APIs failed');
          qrImg.alt = 'QR Codeè¼‰å…¥å¤±æ•—';
        };
      };
    };
    
    qrImg.onload = function() {
      console.log('QR Code with logo generated successfully for:', liffUrl);
    };
  }

  // ä¸»è¦åŸ·è¡Œå‡½å¼ï¼šå„ªå…ˆè™•ç†é›»è…¦ç‰ˆQR codeé¡¯ç¤º
  async function main() {
    try {
      // å„ªå…ˆæª¢æŸ¥è¢å¹•å¯¬åº¦ï¼Œå¦‚æœ >= 768px ç›´æ¥é¡¯ç¤ºQR code
      if (window.innerWidth >= 768) {
        console.log('Desktop detected, generating QR code...');
        generateQRCode();
        return;
      }

      // å°è¢å¹•åŸ·è¡ŒåŸæœ¬çš„LIFFæµç¨‹
      console.log('Mobile detected, initializing LIFF...');
      
      // åˆå§‹åŒ–LIFF SDK
      await liff.init({ liffId: "2006833424-LyakNG2R" });
      await liff.ready;

      // æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦å·²ç™»å…¥LINE
      if (!liff.isLoggedIn()) {
        liff.login();
        return;
      }

      // å–å¾—ä½¿ç”¨è€…è³‡æ–™
      const profile = await liff.getProfile();
      const uid = profile.userId;
      const nickname = profile.displayName;

      // å»ºæ§‹Ragicè¡¨å–®ç¶²å€ï¼Œä¸¦é å¡«ä½¿ç”¨è€…è³‡æ–™
      const ragicUrl = `https://ap13.ragic.com/OnePlaceLiving/harvey/25?webview&webaction=form&ver=new&version=2&pfv1015070=${uid}&pfv1015123=${encodeURIComponent(nickname)}`;

      // ä½¿ç”¨LIFFé–‹å•Ÿå¤–éƒ¨ç€è¦½å™¨è¦–çª—
      liff.openWindow({
        url: ragicUrl,
        external: true
      });
      // 1 ç§’å¾Œè‡ªå‹•é—œé–‰ LIFF è¦–çª—
setTimeout(() => {
  liff.closeWindow();
}, 1000);
    } catch (e) {
      // éŒ¯èª¤è™•ç†ï¼šé¡¯ç¤ºåˆå§‹åŒ–å¤±æ•—è¨Šæ¯
      const errorContainer = document.querySelector('.logo-container') || document.querySelector('.desktop-container');
      if (errorContainer) {
        errorContainer.innerHTML = "<p>åˆå§‹åŒ–å¤±æ•—ï¼š" + e.message + "</p>";
      }
      console.error('Error:', e);
    }
  }

  // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œä¸»å‡½å¼
  document.addEventListener('DOMContentLoaded', main);
  
  // å¦‚æœDOMContentLoadedå·²ç¶“è§¸ç™¼ï¼Œç›´æ¥åŸ·è¡Œ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', main);
  } else {
    main();
  }
</script>
</body>
</html>
